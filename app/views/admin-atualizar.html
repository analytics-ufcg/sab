<div class="section section-gray section-expande">
  <div class="container">
    <h1 class="text-center">Atualizar histórico</h1>

    <div id="step1" class="step" ng-show="ctrl.step === 1">
      <h2>Selecione o reservatório</h2>
      <p>Para começar, precisamos saber qual reservatório será atualizado. Se necessário, baixe o histórico atual.</p>
      <div class="step-form">
        <div class="form-group">
          <input
            type="text"
            class="form-control search-input"
            placeholder="Pesquisar reservatório..."
            ng-model="selectedReservat"
            uib-typeahead="reservatorio as reservatorio.reservat for reservatorio in ctrl.reservatorios | filter:$viewValue"
            typeahead-min-length="3"
            typeahead-on-select="ctrl.setReservatorio(selectedReservat);">
        </div>
      </div>

      <div class="step-content">
        <div ng-show="ctrl.selectedReservat.nome"><strong>Nome</strong> {{ctrl.selectedReservat.nome}}</div>
        <div ng-show="ctrl.selectedReservat.municipio"><strong>Localidade</strong> {{ctrl.selectedReservat.municipio + ' - ' + ctrl.selectedReservat.estado}}</div>
        <div ng-show="ctrl.selectedReservat.bacia"><strong>Bacia</strong> {{ctrl.selectedReservat.bacia}}</div>
        <div ng-show="ctrl.selectedReservat.tipo"><strong>Tipo</strong> {{ctrl.selectedReservat.tipo}}</div>
        <div ng-show="ctrl.selectedReservat.area > 0"><strong>Área</strong> {{ctrl.selectedReservat.area | sabArea}}</div>
        <div class="text-right" ng-show="ctrl.selectedReservat.id">
          <a
          ng-href="{{ctrl.RESTAPI.url}}/reservatorios/{{ctrl.selectedReservat.id}}/monitoramento/csv"
          target="_blank"
          class="btn btn-primary">
            <span class="glyphicon glyphicon-download"></span> Baixar histórico completo
          </a>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6 col-sm-offset-6">
          <button
            type="button"
            class="btn btn-primary btn-lg btn-block"
            ng-disabled="!ctrl.selectedReservat.id"
            ng-click="ctrl.setStep(2);">
              Próximo <span class="glyphicon glyphicon-chevron-right"></span>
          </button>
        </div>
      </div>
    </div>

    <div id="step2" class="step" ng-show="ctrl.step === 2">
      <h2>Envie o arquivo com o novo histórico</h2>
      <p>Todo o histórico deste reservatório será subistituído pelo arquivo enviado.</p>

      <form name="sendFileForm" action="index.html" method="post">
        <div class="step-form">
          <div class="input-group">
            <label class="input-group-btn">
              <span class="btn btn-primary">
                  Carregar arquivo&hellip;
                  <input type="file" style="display: none;"
                    type="file"
                    ngf-select
                    required
                    ng-model="csvFile"
                    name="file"
                    ngf-max-size="2MB"
                    class="form-control btn btn-default">
              </span>
            </label>
            <input type="text" class="form-control" ng-model="csvFile.name" readonly>
          </div>
          <div class="checkbox">
            <label>
              <input type="checkbox" required> Fiz as alterações necessárias
            </label>
          </div>
        </div>
        <div class="step-content">
          <div class="progress">
            <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
              <span class="sr-only">60% Complete</span>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-sm-6 col-sm-offset-6">
            <button
              type="button"
              class="btn btn-primary btn-lg btn-block"
              ng-disabled="!sendFileForm.$valid"
              ng-click="ctrl.sendFile(csvFile)"
              ladda="ctrl.sending"
              data-style="expand-left">
                <span ng-hide="ctrl.sending">Enviar</span><span ng-show="ctrl.sending">Enviando...</span>
            </button>
          </div>
        </div>
      </form>

    </div>

    <div class="step-indicators carousel slide">
      <ol class="carousel-indicators">
        <li ng-class="{'active': ctrl.step === 1}" ng-click="ctrl.setStep(1);"></li>
        <li ng-class="{'active': ctrl.step === 2}" ng-click="ctrl.setStep(2);"></li>
      </ol>
    </div>

  </div>
</div>

<ng-include src="'views/footer.html'"></ng-include>
